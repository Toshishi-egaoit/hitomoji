日本語IME「ひともじ」

ひともじ、は日本語を主体としたIME（Input Method Environment)である。

このアプリケーションは冨樫雅人氏作成の日本語IME「風」をベースとしつつ、UNICODE対応などの
近代化を図っている。
これによって、風の目指した「文字は自分で選ぶもの」というコンセプトを現代に復活させたいと考えている。

技術的には、風がIMM32ベースの32bitアプリなのに対して、「ひともじ」はTSF（Text Service Framework）
ベースの32bit/64bit両対応アプリとして実装している。

ひともじのリポジトリは以下で公開している。
https://github.com/toshishi-egaoit/hitomoji


ロードマップ（2026.2.6版）

現状、v0.1.5までを実装済み。

# hitomoji v0.1系統

目的：
　IMEとしての最低限のキー入力と確定処理が行えること。
　コードは、TSFインタフェース部分とエンジン部の厳密な分離までは求めない。
  これは、分析中毒を防ぐため。

## v0.1 ゴール定義

目的：IMEとしての最小動作確認。入力イベントと Composition の骨格を作る段階。

- IMEのON/OFFができること（Ctrl + Space）
- KeyEventSink の最小限の動作
-- OnTestKeyDown
-- OnKeyDown
-- OnSetFocus(フォーカス変更は未対応)
- ひらがな変換・カタカナ変換は しない
- 変換キーは 存在しない
- Composition の実装
- インライン変換中表示の実装
- 確定キー（Return）による処理
-- 変換中文字列を確定
-- Composition を破棄

## v0.1.1 ゴール定義

目的：ローマ字→ひらがなの最低限の流し込み。

- ひらがな変換マップの作成
- 変換中 Composition に、
-- アルファベット → ひらがな変換結果を与える
- ひらがな確定キーの実装
- カタカナ確定キーの実装
- 英文字変換は実装しない
- 半角カタカナは実装しない
- カナ入力は実装しない
- 変換キーは 実装しない

## v0.1.2 ゴール定義

目的：ソースの整理

- TSFインタフェース部とエンジン部の分離
- エンジン部は、TSFに依存しない形とし、現状のCContytollerをChmEngineに改名
- TSFインタフェース部は現状のCHitomojiをChmTsfIfにリネームしてファクタリング
- DoEditSessionのエンジン依存処理を切り出して、ChmEngineに移動
- 機能追加は行わないが、バグ修正と、TSF対応アプリの拡充は行う(Edgeをターゲットとする)

## v0.1.3 ゴール定義

目的：英字入力系の分離と整理。

- （半角）英文字確定キーの実装	
- 大文字入力サポート
- 記号類の入力サポート
- 実入力されたアルファベットの内部記録が必要
- そのため v0.1.1 では除外
- 全角英文字変換キーの実装

## v0.1.4 ゴール定義

目的：カナ入力、英字入力の精密な定義

- 大文字と小文字の識別（CapsLockも含めて）
- カナ変換時のウ゛の扱い、UNICODE定義されているカナの扱い
- ワ行のい、えの扱い
- てぃ、でぃ、じぇ、などの扱い

## v0.1.5 ゴール定義

目的：編集キーの充実

- ESCによるキャンセル処理(v0.1.4で実装済み)
- BSによる文字削除処理
- v0.2で実装予定のIME個人設定用クラスを作り、BSの挙動を変更できるようにする。
  -- BSを押すと、かな1文字分の削除か、アルファベット１文字削除か選択できる。
  -- DisplayModeとして、未確定文字をかな表示するか、アルファベット表示するか選択できる。
- 矢印キーを押すとかな確定した上でカーソルキーをアプリに渡す
- マウスクリックによる挿入ポイント移動もカーソルキーと同様とする。
- notepadとVS2022、Explorerを目標として、IMEとしての機能が動作することを検証
- Compositionの確定後にのカーソル位置を正しく設定する。
　notepadなど素直なアプリには対応済み
- 以下は当初実装予定だったが、不要と判断し実装しないこととする。
　-- 矢印キーの処理
　-- INSによる挿入モード

## v0.1.6 ゴール定義

目的：Windows依存の処理を実装し、配布可能なパッケージ化する

- この時点では、致命的でない不具合はOKとする。
- 確定後のカーソル位置をただしく設定する。（入力中の表示バグは許容）
- 「ひともじ」アイコンの作成。アイコンはIME ON/OFFの２パターン「A」と「あ」
- 32ビット版(x86)のビルドを行い動作確認をする。
- インストーラ（64/32の両方が動作するように）を作成。

# v0.2系統

目的：環境設定（個人設定）が行えるようになる。

- 環境ファイル（.ini形式など）の作成
- 環境情報管理クラスの作成
- アイコンの右クリック対応（設定ファイルのOpenなど）

# v0.3系統

目的：デッドキーを含めた、欧米向きの第二層の確定入力など、漢字変換以外の機構を作る

# v0.3.0

目的：先回り置換機能の実装

- 変換中の文字列に対して、確定前に置換を行う機能
- いわばローマ字変換と同様にU+2xxxあたりの記号をASCIIで入力できるようにする
- これを「先回り置換」と呼ぶ
- 欧米向けに→記号、数学記号、ギリシャ文字などを対象とする
- ろーまじカナ変換とは独立に実装するが、同じエンジンを利用し、サブクラス化して実装する
- 先回り置換の複数エンジンの評価順序をサポートするMgrクラスを実装する

# v0.3.1

目的：短文変換機能の実装

- 短文変換辞書の構造の決定
- 短文登録の仕組みの実装

# v0.3.2

目的：一部の特殊文字などの変換を利用できるようにする。

　「風」のギリシャ語入力、算術記号入力などと同等の機能
　事実上、漢字変換のロジックの多くがここで実装される見込み。

- 漢字辞書の構造の決定
- 変換中ウィンドウの生成

# v0.4系統

目的：漢字データベースの整備
　漢字辞書の編集ツールの作成
　ここでは、ひともじ本体への改修はほぼない見込み

- 辞書メンテツールの作成
- 漢字の使用頻度を用いたデータベースの生成ロジック検討
- 風との辞書互換はあまり考えない。（結果として同じになるのはOK)

# v0.5系統

目的：漢字変換処理の実装

- 辞書構造の再検討（必要なら）
- 性能検証（辞書をフル実装した場合）

# v0.6系統

目的：漢字変換での付加機能の実装

- 複数の読みを指定する方式（風の：指定相当の機能）
- 漢字の属性を指定する方式（新規。部首やカテゴリ、教育漢字指定など）
- 異体字対応（無理ならパス）

# v0.7系統

目的：コードの整理とIMM32対応
 
- IMM32インタフェース部の実装
- IMM32/TSFの切り替えアルゴリズムの検討と実装
- 対象アプリの拡充（IMM32アプリの動作確認）


